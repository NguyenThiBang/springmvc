<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
</head>
<body>
    <!-- Product Card Fragment -->
    <div th:fragment="product-card(product)" class="card product-card shadow-sm h-100">
        <div class="position-relative">
            <img th:src="${product.imageUrl}" 
                 th:alt="${product.name}"
                 class="card-img-top product-image"
                 onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
            <div class="position-absolute top-0 end-0 m-2">
                <span class="badge bg-success" th:if="${product.stockQuantity > 0}">Còn hàng</span>
                <span class="badge bg-danger" th:if="${product.stockQuantity <= 0}">Hết hàng</span>
            </div>
        </div>
        
        <div class="card-body d-flex flex-column">
            <h6 class="card-title" th:text="${product.name}">Product Name</h6>
            <p class="card-text text-muted small" th:text="${#strings.abbreviate(product.description, 80)}">
                Product description
            </p>
            
            <div class="mt-auto">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="price-badge" th:text="${#currency.formatVND(product.price)}">
                        12.000.000 ₫
                    </span>
                    <small class="text-muted" th:text="${product.brand}">Brand</small>
                </div>                  <div class="d-grid gap-2">
                    <a th:href="@{/products/{id}(id=${product.id})}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye"></i> Xem chi tiết
                    </a>
                    
                    <!-- Add to Cart Button (Always Visible) -->
                    <button th:if="${product.stockQuantity > 0}" 
                            type="button" 
                            class="btn btn-primary btn-sm w-100 add-to-cart-btn"
                            th:data-product-id="${product.id}">
                        <i class="fas fa-cart-plus"></i> Thêm vào giỏ
                    </button>
                    
                    <!-- Buy Now Button (Always Visible) -->
                    <button th:if="${product.stockQuantity > 0}" 
                            type="button" 
                            class="btn btn-success btn-sm w-100 buy-now-btn"
                            th:data-product-id="${product.id}">
                        <i class="fas fa-shopping-bag"></i> Mua ngay
                    </button>
                    
                    <!-- Out of Stock Button -->
                    <button th:if="${product.stockQuantity <= 0}" 
                            class="btn btn-secondary btn-sm w-100" 
                            disabled>
                        <i class="fas fa-ban"></i> Hết hàng
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Compact Product Card Fragment for Lists -->
    <div th:fragment="product-card-compact(product)" class="card product-card-compact shadow-sm h-100">
        <div class="row g-0">
            <div class="col-md-4">
                <img th:src="${product.imageUrl}" 
                     th:alt="${product.name}"
                     class="img-fluid rounded-start h-100 object-cover"
                     onerror="this.src='https://via.placeholder.com/200x150?text=No+Image'">
            </div>
            <div class="col-md-8">
                <div class="card-body d-flex flex-column h-100">
                    <h6 class="card-title" th:text="${product.name}">Product Name</h6>
                    <p class="card-text text-muted small" th:text="${#strings.abbreviate(product.description, 100)}">
                        Product description
                    </p>
                    
                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="price-badge" th:text="${#currency.formatVND(product.price)}">
                                12.000.000 ₫
                            </span>
                            <span class="badge bg-success" th:if="${product.stockQuantity > 0}">Còn hàng</span>
                            <span class="badge bg-danger" th:if="${product.stockQuantity <= 0}">Hết hàng</span>
                        </div>                          <div class="d-flex gap-2">
                            <a th:href="@{/products/{id}(id=${product.id})}" class="btn btn-outline-primary btn-sm flex-fill">
                                <i class="fas fa-eye"></i> Xem
                            </a>
                            
                            <!-- Add to Cart Button for Compact View (Always Visible) -->
                            <button th:if="${product.stockQuantity > 0}" 
                                    type="button" 
                                    class="btn btn-primary btn-sm flex-fill add-to-cart-btn"
                                    th:data-product-id="${product.id}">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                            
                            <!-- Buy Now Button for Compact View -->
                            <button th:if="${product.stockQuantity > 0}" 
                                    type="button" 
                                    class="btn btn-success btn-sm flex-fill buy-now-btn"
                                    th:data-product-id="${product.id}">
                                <i class="fas fa-shopping-bag"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
